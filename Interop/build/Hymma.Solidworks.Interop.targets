<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
	<!-- <Target Name="sldworks" AfterTargets="ResolveReferences" BeforeTargets="FindReferenceAssembliesForReferences">
		<ItemGroup>
			<ReferencePath Condition="'%(FileName)' == 'SolidWorks.Interop.sldworks' AND '%(ReferencePath.NuGetPackageId)' == '$(MSBuildThisFileName)' ">
				<EmbedInteropTypes>False</EmbedInteropTypes>
			</ReferencePath>
		</ItemGroup>
	</Target>
	<Target Name="swpublished" AfterTargets="ResolveReferences" BeforeTargets="FindReferenceAssembliesForReferences">
		<ItemGroup>
			<ReferencePath Condition="'%(FileName)' == 'SolidWorks.Interop.swpublished' AND '%(ReferencePath.NuGetPackageId)' == '$(MSBuildThisFileName)' ">
				<EmbedInteropTypes>False</EmbedInteropTypes>
			</ReferencePath>
		</ItemGroup>
	</Target>
	<Target Name="swconst" AfterTargets="ResolveReferences" BeforeTargets="FindReferenceAssembliesForReferences">
		<ItemGroup>
			<ReferencePath Condition="'%(FileName)' == 'SolidWorks.Interop.swconst' AND '%(ReferencePath.NuGetPackageId)' == '$(MSBuildThisFileName)' ">
				<EmbedInteropTypes>False</EmbedInteropTypes>
			</ReferencePath>
		</ItemGroup>
	</Target> -->
	<PropertyGroup>
		<removeEmbedmentScript>
			$(PowerShell)
			#
			# this powershell script is borrowed form https://xarial.com/
			#
			param($installPath, $toolsPath, $package, $project)
$project.Object.References | Where-Object { $_.Name -eq "SolidWorks.Interop.sldworks" } |  ForEach-Object { $_.EmbedInteropTypes = $false }
$project.Object.References | Where-Object { $_.Name -eq "SolidWorks.Interop.swconst" } |  ForEach-Object { $_.EmbedInteropTypes = $false }
$project.Object.References | Where-Object { $_.Name -eq "SolidWorks.Interop.swpublished" } |  ForEach-Object { $_.EmbedInteropTypes = $false }
		</removeEmbedmentScript>
	</PropertyGroup>
	<Target Name="removeEmbedment" AfterTargets="ResolveReferences" BeforeTargets="FindReferenceAssembliesForReferences">
		<Exec Command="$(removeEmbedmentScript)" EchoOff="false"/>
	</Target>
</Project>